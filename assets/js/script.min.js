jQuery(function(r){r(document.body).on("click",".nmgrcf-post-action",function(t){t.preventDefault();var n=[this];if(this.dataset.nmgr_block)try{var o=JSON.parse(this.dataset.nmgr_block),o=Array.isArray(o)?o:[o];n=n.concat(o)}catch(t){console.warn(t)}var e={btn:this,block:n,postdata:this.dataset};nmgr.hasOwnProperty("post_action")&&nmgr.post_action(e)}).on("nmgr_post_action_response",function(t,n){n.response.replace_templates&&(n.response.replace_templates.hasOwnProperty("#nmgr-free_contributions")&&nmgr.free_contributions.reloaded(n.response.wishlist||null),n.response.replace_templates.hasOwnProperty("#nmgr-crowdfunds")&&nmgr.crowdfunds.reloaded(n.response.wishlist||null))}).on("submit",".nmgrcf-form",function(t){{var n;t.preventDefault(),"function"==typeof Nmeri_getFormdata&&(n=Object.assign(Nmeri_getFormdata(this),{nmgr_post_action:this.dataset.nmgr_post_action,nmgr_global:JSON.stringify(nmgr_global_params.global)}),n={block:this,btn:t.originalEvent.submitter,postdata:n},nmgr.post_action(n))}}).on("click","[data-nmgrcf_disabled_notice]",function(t){t.preventDefault();t=this.dataset.nmgrcf_disabled_notice;t&&alert(t)}),nmgr.crowdfunds={init:function(){r(document.body).on("change",".atw-cf-enable",this.toggle_options_container).on("change","select.list-of-wishlists",this.update_crowdfund_status_for_wishlist)},reloaded:function(){r(document.body).trigger("nmgrcf_crowdfunds_reloaded")},toggle_options_container:function(){var t=r("."+r(this).attr("data-options"));r(this).is(":checked")?t.slideDown(200):t.slideUp(200).find("input").val("")},update_crowdfund_status_for_wishlist:function(){var t=r(this).val(),n="data-in-wishlist-"+t,o="data-purchased-"+t,t=r(".nmgr.dialog.show").find(".atw-cf-enable");t.length&&r(t).each(function(){r(this).attr(n)===r(this).val()&&r(this).attr(o)===r(this).val()?(this.disabled=!0,r(this).next("label").click(function(){r(this).attr("data-has-contribution-text")&&alert(r(this).attr("data-has-contribution-text"))})):this.disabled=!1})}},nmgr.crowdfunds.init(),nmgr.free_contributions={container:"#nmgrcf-free-contributions",init:function(){r(document.body).on("click",".nmgrcf_fc_add_to_cart_button.nmgr_ajax_add_to_cart",this.add_to_cart)},reloaded:function(){r(document.body).trigger("nmgrcf_free_contributions_reloaded")},add_to_cart:function(t){var n=r(this),o=n.closest("form"),e={action:"nmgrcf_fc_add_to_cart",nmgr_global:JSON.stringify(nmgr_global_params.global)};t.preventDefault(),r(o.serializeArray()).each(function(t,n){e[n.name]=n.value}),n.removeClass("added").addClass("loading"),r.post(nmgr_global_params.ajax_url,e,function(t){t.fragments&&(t.fragments.success&&t.fragments.redirect_url?window.location=t.fragments.redirect_url:(r(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),r(document.body).trigger("nmgrcf_free_contribution_add_to_cart_response",t.fragments),n.removeClass("loading"),t.fragments.notices&&"function"==typeof Nmeri_showToast&&t.fragments.notices.forEach(function(t){Nmeri_showToast(t)}),t.fragments.success&&(r(document.body).trigger("added_to_cart",[t.fragments,t.cart_hash]),r(document.body).trigger("nmgrcf_free_contribution_added_to_cart",[t.fragments]))))})}},nmgr.free_contributions.init(),nmgrcf_coupons={init:function(){r(document.body).on("show.bs.modal",".nmgrcf-create-coupon-dialog",this.init_create_coupon_form).on("click",".nmgr-after-table-row.coupons > header .nmgr-action",this.toggle_coupons_table)},init_create_coupon_form:function(){r("select.nmgr-coupon-product-ids").select2()},toggle_coupons_table:function(){r(".nmgrcf-coupons-table").toggleClass("nmgr-hide")}},nmgrcf_coupons.init()});